{{- if isset .Params "book" -}}
{{- $.Scratch.Set "booktitle" (.Params.book.title | default $.Site.Params.book.title) -}}
{{- $.Scratch.Set "publisher" (.Params.book.publisher | default $.Site.Params.book.publisher) -}}
{{- $.Scratch.Set "isbn" (.Params.book.isbn | default $.Site.Params.book.isbn) -}}
{{- $.Scratch.Set "bookyear" (.Params.book.year | default $.Site.Params.book.year) -}}
{{- else -}}
{{- $.Scratch.Set "booktitle" $.Site.Params.book.title -}}
{{- $.Scratch.Set "publisher" $.Site.Params.book.publisher -}}
{{- $.Scratch.Set "isbn" $.Site.Params.book.isbn -}}
{{- $.Scratch.Set "bookyear" $.Site.Params.book.year -}}
{{- end -}}
{{- $booktitle := ($.Scratch.Get "booktitle") -}}
{{- $publisher := ($.Scratch.Get "publisher") -}}
{{- $isbn := ($.Scratch.Get "isbn") -}}
{{- $bookyear := ($.Scratch.Get "bookyear") -}}

<article class="postlist">
  <article itemscope itemtype="http://schema.org/ScholarlyArticle">
    <span itemprop="isPartOf" itemscope itemtype="http://schema.org/Book">
      <meta itemprop="name" content="{{ $booktitle }}"/>
      <span itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
        <meta itemprop="name" content="{{ $publisher }}"/>
      </span>
      <meta itemprop="datepublished" content="{{ $bookyear }}"/>
      <meta itemprop="isbn" content="{{ $isbn }}"/>
    </span>
    <h2>Chapter {{ .Params.chapter | markdownify }}, "{{ .Params.title | markdownify }}"</h2>

    {{ if .Truncated }}
    {{ .Summary | markdownify }}
    <span class="text-right" style="margin-left:1em;font-size:80%;">&rarr; <a href="{{ .RelPermalink }}">Read Moreâ€¦</a></span>
    {{- else }}
    <div itemprop="articleBody">
    {{ .Content }}
    </div>
    {{- end }}
  </article>
</article>
